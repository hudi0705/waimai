{"version":3,"file":"checkout.js","sources":["pages/order/checkout/checkout.vue","D:/360MoveData/Users/86156/Desktop/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvb3JkZXIvY2hlY2tvdXQvY2hlY2tvdXQudnVl"],"sourcesContent":["<template>\n  <view class=\"container\">\n    <view class=\"header\">\n      <text>请确认您的订单</text>\n    </view>\n\n    <view class=\"section\">\n      <view class=\"section-title\">订单详情</view>\n      <view class=\"order-item\" v-for=\"(item, index) in orderDetail.order_food\" :key=\"index\">\n        <image class=\"item-image\" :src=\"item.image_url\"></image>\n        <view class=\"item-info\">\n          <text class=\"item-name\">{{ item.name }}</text>\n          <text class=\"item-quantity\">x {{ item.number }}</text>\n        </view>\n        <text class=\"item-price\">￥{{ parseFloat(item.price).toFixed(2) }}</text>\n      </view>\n      <view class=\"subtotal\">\n        <text>小计</text>\n        <text>￥{{ parseFloat(orderDetail.price).toFixed(2) }}</text>\n      </view>\n    </view>\n\n    <view class=\"section\">\n      <view class=\"section-title\">备注</view>\n      <textarea class=\"notes-textarea\" v-model=\"orderDetail.comment\" placeholder=\"如有其他要求，请输入备注\"></textarea>\n    </view>\n\n    <view class=\"footer\">\n      <view class=\"total-price-info\">\n        <text>合计:</text>\n        <text class=\"total-price\">￥{{ (parseFloat(orderDetail.price) - parseFloat(orderDetail.promotion)).toFixed(2)\n        }}</text>\n      </view>\n      <view class=\"pay-button\" @click=\"goToPay()\">去支付</view>\n    </view>\n  </view>\n</template>\n\n<script>\nexport default {\n  data() {\n    return {\n      orderId: null,\n      orderDetail: {\n      \n      },\n      phpsessid: null\n    };\n  },\n  onLoad(options) {\n    if (options.order_id) {\n      this.orderId = options.order_id;\n      if (options.phpsessid) {\n        this.phpsessid = options.phpsessid;\n      }\n      this.getOrderDetails(this.orderId);\n    }\n  },\n  methods: {\n    getOrderDetails(orderId) {\n      uni.showLoading({\n        title: '加载中'\n      });\n      uni.request({\n        url: `http://localhost/api/food/order?id=${orderId}`,\n        method: 'GET',\n        header: {\n          'Cookie': this.phpsessid ? 'PHPSESSID=' + this.phpsessid : ''\n        },\n        success: (res) => {\n          console.log('API Response:', res.data);\n          if (res.data) {\n            this.orderDetail = res.data;\n            // 确保 order_food 是数组\n          \n          }\n        },\n        fail: (error) => {\n          console.error('请求失败:', error);\n          uni.showModal({\n            title: '获取订单失败',\n            content: '网络请求失败，请重试',\n            showCancel: false\n          });\n        },\n        complete: () => {\n          uni.hideLoading();\n        }\n      });\n    },\n    goToPay() {\n      uni.request({\r\n      \turl:'http://localhost/api/food/pay',\r\n\t\tmethod:'POST',\r\n\t\theader: {\r\n\t\t  'Cookie': this.phpsessid ? 'PHPSESSID=' + this.phpsessid : ''\r\n\t\t},\r\n\t\tdata:{\r\n\t\t\tid:this.orderId\r\n\t\t},\r\n\t\tsuccess: (res) => {\r\n\t\tif(res.data.msg=='支付成功'){\r\n\t\t\tuni.navigateTo({\r\n\t\t\t\turl:`/pages/one/one?order_id=${this.orderId}&phpsessid=${this.phpsessid}`\r\n\t\t\t})\r\n\t\t}\r\n\t\t}\r\n      })\n      uni.showLoading({\n        title: '处理中'\n      });\n      // 这里添加支付相关的API调用\n      setTimeout(() => {\n        uni.hideLoading();\n        uni.showToast({\n          title: '支付功能开发中',\n          icon: 'none'\n        });\n      }, 1000);\n    }\n  }\n};\n</script>\n\n<style>\npage {\n  background-color: #f8f8f8;\n}\n\n.container {\n  display: flex;\n  flex-direction: column;\n  min-height: 100vh;\n  padding-bottom: 120rpx;\n  /* Space for the fixed footer */\n}\n\n.header {\n  background-color: white;\n  padding: 30rpx;\n  font-size: 36rpx;\n  font-weight: bold;\n  text-align: center;\n  border-bottom: 1rpx solid #eee;\n}\n\n.section {\n  background-color: white;\n  margin-top: 20rpx;\n  padding: 20rpx 30rpx;\n  border-radius: 8rpx;\n}\n\n.section-title {\n  font-size: 32rpx;\n  font-weight: bold;\n  margin-bottom: 20rpx;\n  color: #333;\n}\n\n.order-item {\n  display: flex;\n  align-items: center;\n  margin-bottom: 20rpx;\n}\n\n.item-image {\n  width: 100rpx;\n  height: 100rpx;\n  margin-right: 20rpx;\n  border-radius: 8rpx;\n  object-fit: cover;\n}\n\n.item-info {\n  flex-grow: 1;\n  display: flex;\n  flex-direction: column;\n}\n\n.item-name {\n  font-size: 30rpx;\n  color: #333;\n}\n\n.item-quantity {\n  font-size: 24rpx;\n  color: #999;\n}\n\n.item-price {\n  font-size: 32rpx;\n  font-weight: bold;\n  color: #333;\n}\n\n.subtotal {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding-top: 20rpx;\n  border-top: 1rpx solid #eee;\n  font-size: 32rpx;\n  font-weight: bold;\n  color: #333;\n}\n\n.notes-textarea {\n  width: 100%;\n  height: 200rpx;\n  border: 1rpx solid #eee;\n  border-radius: 8rpx;\n  padding: 20rpx;\n  box-sizing: border-box;\n  font-size: 28rpx;\n  color: #333;\n}\n\n.footer {\n  position: fixed;\n  bottom: 0;\n  left: 0;\n  width: 100%;\n  height: 120rpx;\n  background-color: #333;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 0 30rpx;\n  box-sizing: border-box;\n  z-index: 100;\n}\n\n.total-price-info {\n  display: flex;\n  align-items: baseline;\n  color: white;\n}\n\n.total-price {\n  font-size: 40rpx;\n  font-weight: bold;\n  margin-left: 10rpx;\n}\n\n.pay-button {\n  background-color: #ff9c35;\n  color: white;\n  padding: 20rpx 40rpx;\n  border-radius: 60rpx;\n  font-size: 36rpx;\n  font-weight: bold;\n}\n</style>","import MiniProgramPage from 'C:/Users/86156/Documents/HBuilderProjects/diancan/pages/order/checkout/checkout.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni"],"mappings":";;AAuCA,MAAK,YAAU;AAAA,EACb,OAAO;AACL,WAAO;AAAA,MACL,SAAS;AAAA,MACT,aAAa,CAEZ;AAAA,MACD,WAAW;AAAA;EAEd;AAAA,EACD,OAAO,SAAS;AACd,QAAI,QAAQ,UAAU;AACpB,WAAK,UAAU,QAAQ;AACvB,UAAI,QAAQ,WAAW;AACrB,aAAK,YAAY,QAAQ;AAAA,MAC3B;AACA,WAAK,gBAAgB,KAAK,OAAO;AAAA,IACnC;AAAA,EACD;AAAA,EACD,SAAS;AAAA,IACP,gBAAgB,SAAS;AACvBA,oBAAAA,MAAI,YAAY;AAAA,QACd,OAAO;AAAA,MACT,CAAC;AACDA,oBAAAA,MAAI,QAAQ;AAAA,QACV,KAAK,sCAAsC,OAAO;AAAA,QAClD,QAAQ;AAAA,QACR,QAAQ;AAAA,UACN,UAAU,KAAK,YAAY,eAAe,KAAK,YAAY;AAAA,QAC5D;AAAA,QACD,SAAS,CAAC,QAAQ;AAChBA,wBAAA,MAAA,MAAA,OAAA,2CAAY,iBAAiB,IAAI,IAAI;AACrC,cAAI,IAAI,MAAM;AACZ,iBAAK,cAAc,IAAI;AAAA,UAGzB;AAAA,QACD;AAAA,QACD,MAAM,CAAC,UAAU;AACfA,wBAAA,MAAA,MAAA,SAAA,2CAAc,SAAS,KAAK;AAC5BA,wBAAAA,MAAI,UAAU;AAAA,YACZ,OAAO;AAAA,YACP,SAAS;AAAA,YACT,YAAY;AAAA,UACd,CAAC;AAAA,QACF;AAAA,QACD,UAAU,MAAM;AACdA,wBAAG,MAAC,YAAW;AAAA,QACjB;AAAA,MACF,CAAC;AAAA,IACF;AAAA,IACD,UAAU;AACRA,oBAAAA,MAAI,QAAQ;AAAA,QACX,KAAI;AAAA,QACT,QAAO;AAAA,QACP,QAAQ;AAAA,UACN,UAAU,KAAK,YAAY,eAAe,KAAK,YAAY;AAAA,QAC5D;AAAA,QACD,MAAK;AAAA,UACJ,IAAG,KAAK;AAAA,QACR;AAAA,QACD,SAAS,CAAC,QAAQ;AAClB,cAAG,IAAI,KAAK,OAAK,QAAO;AACvBA,0BAAAA,MAAI,WAAW;AAAA,cACd,KAAI,2BAA2B,KAAK,OAAO,cAAc,KAAK,SAAS;AAAA,aACvE;AAAA,UACF;AAAA,QACA;AAAA,OACK;AACDA,oBAAAA,MAAI,YAAY;AAAA,QACd,OAAO;AAAA,MACT,CAAC;AAED,iBAAW,MAAM;AACfA,sBAAG,MAAC,YAAW;AACfA,sBAAAA,MAAI,UAAU;AAAA,UACZ,OAAO;AAAA,UACP,MAAM;AAAA,QACR,CAAC;AAAA,MACF,GAAE,GAAI;AAAA,IACT;AAAA,EACF;AACF;;;;;;;;;;;;;;;;;;;;ACxHA,GAAG,WAAW,eAAe;"}