{"version":3,"file":"list.js","sources":["pages/list/list.vue","D:/360MoveData/Users/86156/Desktop/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvbGlzdC9saXN0LnZ1ZQ"],"sourcesContent":["<template>\n\t<view class=\"order-list-container\">\n\t\t<view class=\"order-item-card\" v-for=\"(order, index) in orderList\" :key=\"index\">\n\t\t\t<view class=\"order-time\">下单时间: {{ order.create_time }}</view>\n\t\t\t<view class=\"order-details\">\n\t\t\t\t<view class=\"food-info\">\n\t\t\t\t\t<text class=\"food-name\">{{ order.first_food_name }}</text>\n\t\t\t\t\t<text class=\"food-quantity\">等{{ order.number }}件商品</text>\n\t\t\t\t\t<text class=\"food-price\">￥{{ parseFloat(order.price).toFixed(2) }}</text>\n\t\t\t\t</view>\n\t\t\t\t<view class=\"action-buttons\">\n\t\t\t\t\t<view class=\"view-details-button\" @click=\"goToDetails(order.order_id)\">查看详情</view>\n\t\t\t\t\t<view :class=\"[order.is_taken ? 'picked-up-button' : 'not-picked-up-button']\">{{ order.is_taken ? '已取餐' :\n\t\t\t\t\t\t'未取餐' }}</view>\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t</view>\n\t</view>\n</template>\n\n<script>\nexport default {\n\tdata() {\n\t\treturn {\n\t\t\torderList: null,\n\t\t\tphpsessid: null,\r\n\t\t\trows:10\n\t\t}\n\t},\n\tonLoad(options) {\n\tthis.login()\r\n\t\t\r\n\n\t\t\n\t},\n\tmethods: {\n\t\tget_lists(){\r\n\t\t\tuni.request({\r\n\t\t\t\turl:`http://localhost/api/food/orderlist?row=${this.rows}`,\r\n\t\t\t\theader:{\r\n\t\t\t\t\t'Cookie': this.phpsessid ? 'PHPSESSID=' + this.phpsessid : ''\r\n\t\t\t\t},\r\n\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\tconsole.log('list',res.data);\r\n\t\t\t\t\tthis.orderList=res.data.list\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t},\n\tlogin() {\r\n\t\tuni.login({\r\n\t\t\tprovider: 'weixin',\r\n\t\t\tsuccess: (loginRes) => {\r\n\t\t\t\t// console.log(loginRes.code);\r\n\t\t\t\tuni.request({\r\n\t\t\t\t\turl: 'http://localhost/api/user/login',\r\n\t\t\t\t\tdata: {\r\n\t\t\t\t\t\tjs_code: loginRes.code\r\n\t\t\t\t\t},\r\n\t\t\t\t\tmethod: 'GET',\r\n\t\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\t\t// 获取 Set-Cookie 头\r\n\t\t\t\t\t\tconst setCookie = res.header['Set-Cookie'];\r\n\t\t\t\t\t\tif (setCookie) {\r\n\t\t\t\t\t\t\t// 解析 Set-Cookie 获取 PHPSESSID\r\n\t\t\t\t\t\t\tconst match = setCookie.match(/PHPSESSID=([^;]+)/);\r\n\t\t\t\t\t\t\tif (match) {\r\n\t\t\t\t\t\t\t\tthis.phpsessid = match[1];\r\n\t\t\t\t\t\t\t\tconsole.log('PHPSESSID1111111:', this.phpsessid);\r\n\t\t\t\t\t\t\t\t// 存储 PHPSESSID 到本地存储\r\n\t\t\t\t\t\t\t\tuni.setStorageSync('PHPSESSID', this.phpsessid);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tconsole.log('登录成功');\r\n\t\t\t\t\t\tthis.get_lists();\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfail: (err) => {\r\n\t\t\t\t\t\tconsole.error('登录请求失败', err);\r\n\t\t\t\t\t\tuni.showModal({\r\n\t\t\t\t\t\t\ttitle: '登录失败，请重试',\r\n\t\t\t\t\t\t\tconfirmText: '重试',\r\n\t\t\t\t\t\t\tsuccess: (modalRes) => {\r\n\t\t\t\t\t\t\t\tif (modalRes.confirm) {\r\n\t\t\t\t\t\t\t\t\tthis.login();\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tfail: (err) => {\r\n\t\t\t\tconsole.error('获取微信登录code失败', err);\r\n\t\t\t\tuni.showModal({\r\n\t\t\t\t\ttitle: '获取登录凭证失败',\r\n\t\t\t\t\tconfirmText: '重试',\r\n\t\t\t\t\tsuccess: (modalRes) => {\r\n\t\t\t\t\t\tif (modalRes.confirm) {\r\n\t\t\t\t\t\t\tthis.login();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn true\r\n\t},\n\t},\r\n\tonReachBottom  () {\r\n\t\tthis.rows+=10\r\n\t\tthis.get_lists()\r\n\t}\n}\n</script>\n\n<style>\npage {\n\tbackground-color: #f8f8f8;\n}\n\n.order-list-container {\n\tpadding: 20rpx;\n}\n\n.order-item-card {\n\tbackground-color: white;\n\tmargin-bottom: 20rpx;\n\tpadding: 20rpx;\n\tborder-radius: 8rpx;\n\tbox-shadow: 0 2rpx 10rpx rgba(0, 0, 0, 0.05);\n}\n\n.order-time {\n\tfont-size: 28rpx;\n\tcolor: #999;\n\tmargin-bottom: 15rpx;\n}\n\n.order-details {\n\tdisplay: flex;\n\tjustify-content: space-between;\n\talign-items: center;\n}\n\n.food-info {\n\tdisplay: flex;\n\tflex-direction: column;\n}\n\n.food-name {\n\tfont-size: 30rpx;\n\tcolor: #333;\n\tmargin-bottom: 5rpx;\n}\n\n.food-quantity {\n\tfont-size: 24rpx;\n\tcolor: #999;\n\tmargin-bottom: 10rpx;\n}\n\n.food-price {\n\tfont-size: 32rpx;\n\tfont-weight: bold;\n\tcolor: #ff9c35;\n}\n\n.action-buttons {\n\tdisplay: flex;\n\tgap: 20rpx;\n}\n\n.view-details-button {\n\tborder: 1rpx solid #ff9c35;\n\tcolor: #ff9c35;\n\tpadding: 10rpx 20rpx;\n\tborder-radius: 40rpx;\n\tfont-size: 28rpx;\n}\n\n.not-picked-up-button {\n\tbackground-color: #ffc107;\n\tcolor: white;\n\tpadding: 10rpx 20rpx;\n\tborder-radius: 40rpx;\n\tfont-size: 28rpx;\n}\n\n.picked-up-button {\n\tbackground-color: #cccccc;\n\tcolor: white;\n\tpadding: 10rpx 20rpx;\n\tborder-radius: 40rpx;\n\tfont-size: 28rpx;\n}\n</style>\n","import MiniProgramPage from 'C:/Users/86156/Documents/HBuilderProjects/diancan/pages/list/list.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni"],"mappings":";;AAqBA,MAAK,YAAU;AAAA,EACd,OAAO;AACN,WAAO;AAAA,MACN,WAAW;AAAA,MACX,WAAW;AAAA,MACX,MAAK;AAAA,IACN;AAAA,EACA;AAAA,EACD,OAAO,SAAS;AAChB,SAAK,MAAM;AAAA,EAIV;AAAA,EACD,SAAS;AAAA,IACR,YAAW;AACVA,oBAAAA,MAAI,QAAQ;AAAA,QACX,KAAI,2CAA2C,KAAK,IAAI;AAAA,QACxD,QAAO;AAAA,UACN,UAAU,KAAK,YAAY,eAAe,KAAK,YAAY;AAAA,QAC3D;AAAA,QACD,SAAS,CAAC,QAAQ;AACjBA,wEAAY,QAAO,IAAI,IAAI;AAC3B,eAAK,YAAU,IAAI,KAAK;AAAA,QACzB;AAAA,OACA;AAAA,IACD;AAAA,IACF,QAAQ;AACPA,oBAAAA,MAAI,MAAM;AAAA,QACT,UAAU;AAAA,QACV,SAAS,CAAC,aAAa;AAEtBA,wBAAAA,MAAI,QAAQ;AAAA,YACX,KAAK;AAAA,YACL,MAAM;AAAA,cACL,SAAS,SAAS;AAAA,YAClB;AAAA,YACD,QAAQ;AAAA,YACR,SAAS,CAAC,QAAQ;AAEjB,oBAAM,YAAY,IAAI,OAAO,YAAY;AACzC,kBAAI,WAAW;AAEd,sBAAM,QAAQ,UAAU,MAAM,mBAAmB;AACjD,oBAAI,OAAO;AACV,uBAAK,YAAY,MAAM,CAAC;AACxBA,gFAAY,qBAAqB,KAAK,SAAS;AAE/CA,gCAAAA,MAAI,eAAe,aAAa,KAAK,SAAS;AAAA,gBAC/C;AAAA,cACD;AACAA,4BAAAA,MAAY,MAAA,OAAA,6BAAA,MAAM;AAClB,mBAAK,UAAS;AAAA,YACd;AAAA,YACD,MAAM,CAAC,QAAQ;AACdA,4BAAc,MAAA,MAAA,SAAA,6BAAA,UAAU,GAAG;AAC3BA,4BAAAA,MAAI,UAAU;AAAA,gBACb,OAAO;AAAA,gBACP,aAAa;AAAA,gBACb,SAAS,CAAC,aAAa;AACtB,sBAAI,SAAS,SAAS;AACrB,yBAAK,MAAK;AAAA,kBACX;AAAA,gBACD;AAAA,cACD,CAAC;AAAA,YACF;AAAA,UACD,CAAC;AAAA,QACD;AAAA,QACD,MAAM,CAAC,QAAQ;AACdA,wBAAc,MAAA,MAAA,SAAA,6BAAA,gBAAgB,GAAG;AACjCA,wBAAAA,MAAI,UAAU;AAAA,YACb,OAAO;AAAA,YACP,aAAa;AAAA,YACb,SAAS,CAAC,aAAa;AACtB,kBAAI,SAAS,SAAS;AACrB,qBAAK,MAAK;AAAA,cACX;AAAA,YACD;AAAA,UACD,CAAC;AAAA,QACF;AAAA,MACD,CAAC;AACD,aAAO;AAAA,IACP;AAAA,EACA;AAAA,EACD,gBAAkB;AACjB,SAAK,QAAM;AACX,SAAK,UAAU;AAAA,EAChB;AACD;;;;;;;;;;;;;;;;;;AC5GA,GAAG,WAAW,eAAe;"}